<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title></title>
<link href="../bootstrap/css/bootstrap.css" rel="stylesheet" />
<style>
.table tr td img{
	width: 54px;
    height: 54px;
}
</style>
</head>
<body>
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span12">
				<h3 class="text-center">淘单.</h3>
				<form class="form-search">
					<select id="username">
						<option value="">全部用户</option>
						<option value="wangtaozgr">wangtaozgr</option>
					</select>
					<input class="input-medium search-query" type="text" />
					<button type="button" class="btn" onclick="loadPageData();">查找</button>
					<button type="button" class="btn btn-primary" id="startTask">开始接任务</button>
					<a href="#myModal" role="button" class="btn btn-danger" data-toggle="modal">设置cookie</a>
					
				</form>
				<table class="table">
					<thead>
						<tr>
							<th>商品</th>
							<th>任务信息</th>
							<th>任务状态</th>
							<th>拼多多订单号</th>
							<th>拼多多状态</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody id="taskBody">
						<script type="text/html" id="taskList">
						{{each list as value i}}	
						<tr class="error">
							<td><img alt="" src="{{value.taskBuyerImg}}"></td>
							<td>{{value.taskNo}}<br/>任务价格：￥{{value.taskPrice}}<br/>任务佣金：{{value.taskGold}}元</td>
							<td>{{value.taskStatus}} </td>
							<td>{{value.taskNo}}</td>
							<td>{{value.taskStatus}} </td>
							<td></td>
						</tr>
						{{/each}}
						</script>
					</tbody>
				</table>
				<div class="pagination pagination-right">
					<ul>
						<li><a href="#">上一页</a></li>
						<li><a href="#">1</a></li>
						<li><a href="#">2</a></li>
						<li><a href="#">3</a></li>
						<li><a href="#">4</a></li>
						<li><a href="#">5</a></li>
						<li><a href="#">下一页</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	
	<!-- Modal -->
	<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
	    <h3 id="myModalLabel">设置cooke</h3>
	  </div>
	  <div class="modal-body form-horizontal">
			<div class="control-group">
			    <label class="control-label" for="i_username">用户名</label>
			    <div class="controls">
			      <select id="i_username">
					 <option value="wangtaozgr">wangtaozgr</option>
				  </select>
			    </div>
		  	</div>
		  	<div class="control-group">
		    	<label class="control-label" for="i_cookiestr">cookie值</label>
		    	<div class="controls">
		     		<textarea rows="3" id="i_cookiestr"></textarea>
		    	</div>
		  	</div>
	  </div>
	  <div class="modal-footer">
	    <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
	    <button class="btn btn-primary" id="saveUserCookieValue">确认</button>
	  </div>
	</div>
	
	<script src="../js/jquery-1.8.2.js"></script>
	<script src="../js/template.js"></script>
	<script src="../bootstrap/js/bootstrap.min.js"></script>
	<script>
		$(function(){
			$("#saveUserCookieValue").click(function(){
				var username = $("#i_username").val();
				var cookiestr = $("#i_cookiestr").val();
				$.ajax({
					type : "post",
					url : "../td/addCookie",
					dataType : 'json',
					data : {
						username : username,
						cookiestr : cookiestr
					},
					success : function(json) {
						console.log(json);
						$("#i_cookiestr").val('');
						$('#myModal').modal('hide');
					}
				});
			});
			
			loadPageData();
		});
		
		function loadPageData(){
			var username = $("#username").val();
			$.ajax({
				type : "post",
				url : "../ddhp/orderPageData",
				dataType : 'json',
				data : {
					username : username
				},
				success : function(data) {
					console.log(data);
					var html1 = template("taskList", {
						list : data.list
					});
					document.getElementById("taskBody").innerHTML = html1;
				}
			});
			
		}
	</script>
</body>
</html>
